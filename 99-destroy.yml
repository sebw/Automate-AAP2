---
- name: ðŸ’¥ðŸ’¥ðŸ’¥ Simulate a disaster! ðŸ’¥ðŸ’¥ðŸ’¥
  hosts: localhost
  gather_facts: False

  vars_files:
  - vault.yml
  - vars.yml

  collections:
  - ansible.controller

  tasks:
  - name: ðŸ§¨ Eliminate user ðŸ§¨
    ansible.controller.user:
      username: "{{ customer }}_user1"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False

  - name: ðŸ§¨ Nuke the project ðŸ§¨
    ansible.controller.project:
      name: "{{ customer }} PROJECT"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False

  - name: ðŸ§¨ Nuke the workflow ðŸ§¨
    ansible.controller.workflow_job_template:
      name: "{{ customer }} WORKFLOW"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False


  - name: ðŸ§¨ Nuke the jobs ðŸ§¨
    ansible.controller.job_template:
      name: "{{ customer }} JOB {{ item }}"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False
    loop:
    - "1"
    - "2"
    - "3"

  - name: ðŸ§¨ Nuke the organization and drag the team with it ðŸ§¨
    ansible.controller.organization:
      name: "{{ customer }} ORG"
      state: absent
      controller_host: "{{ aap2_host }}"
      controller_username: "{{ aap2_username }}"
      controller_password: "{{ aap2_password }}"
      validate_certs: False
